import{_ as p}from"./gzh.b03adfd2.js";import{_ as t}from"./zsxq.77f6dc86.js";import{_ as e}from"./_plugin-vue_export-helper.cdc0426e.js";import{o,c,a as n,d as s,b as l,e as u,r as i}from"./app.f305e642.js";const k="/assets/image-20220715211758604.77d85035.png",r="/assets/image-20220715221653761.4422aaa4.png",d="/assets/image-20220715222043587.a80281e5.png",m="/assets/image-20220715222746640.ecd66a7d.png",b={},v=u('<h2 id="实例需求说明" tabindex="-1"><a class="header-anchor" href="#实例需求说明" aria-hidden="true">#</a> 实例需求说明</h2><p>学习了 Excel 文件的写入、读取和追加内容，那现在来做个案例。</p><p>需求描述并整理，如下：</p><ul><li>每个月的 2 号，你会收到一个 Excel 文件；</li><li>文件中包含了 各个部门的员工信息；</li><li>你需要一天之内完成这些报表的整理和统计，然后交给领导检查和发放工资；</li><li>时间要快，工资发晚了，同事会抱怨你；</li><li>工作量还是比较大的，你需要解放双手，让程序去处理问题</li><li>让程序快速的计算出每个人的工资，并将统计信息结合模板，生成“<code>xxxx年xx月各部门员工数据总览</code>”；</li><li>薪资计算规定：迟到一次扣 20，一个月最多扣 200；</li></ul><p>简单的财务自动化结算需求，并且给出了各部门的工资表格文件和统计报表的模板文件。</p><h2 id="需求说明图示" tabindex="-1"><a class="header-anchor" href="#需求说明图示" aria-hidden="true">#</a> 需求说明图示</h2><p>简单的财务自动化结算需求，并且给出了各部门的工资表格文件和统计报表的模板文件，截图如下：</p><p><img src="'+k+`" alt="image-20220715211758604" loading="lazy"></p><p>“<code>批量生成财务报表.ipynb</code>”这个文件里面有可执行代码，执行后会自动的生成 5 个部门的财务文件。你也可以自己使用下面代码自动生成：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># @Time    : 2022/7/15 21:48</span>
<span class="token comment"># @Author  : AI悦创</span>
<span class="token comment"># @FileName: demo2.py</span>
<span class="token comment"># @Software: PyCharm</span>
<span class="token comment"># @Blog    ：http://www.aiyc.top</span>
<span class="token comment"># @公众号   ：AI悦创</span>
<span class="token keyword">import</span> xlwt
<span class="token keyword">import</span> faker
<span class="token keyword">import</span> random
<span class="token keyword">import</span> datetime


<span class="token keyword">def</span> <span class="token function">create_excel_file</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> department<span class="token punctuation">)</span><span class="token punctuation">:</span>
    wb <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
    sheet <span class="token operator">=</span> wb<span class="token punctuation">.</span>add_sheet<span class="token punctuation">(</span><span class="token string">&#39;sheet1&#39;</span><span class="token punctuation">)</span>
    fake <span class="token operator">=</span> faker<span class="token punctuation">.</span>Faker<span class="token punctuation">(</span><span class="token string">&quot;zh_CN&quot;</span><span class="token punctuation">)</span>
    head_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;部门&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;姓名&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;工号&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;薪资（元）&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;迟到次数（次）&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;奖金（元）&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;实发工资&#39;</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> head <span class="token keyword">in</span> head_data<span class="token punctuation">:</span>
        sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> head_data<span class="token punctuation">.</span>index<span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">,</span> head<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> department<span class="token punctuation">)</span>
        sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> fake<span class="token punctuation">.</span>last_name<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> fake<span class="token punctuation">.</span>first_name<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;G{}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">,</span> <span class="token number">16000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">700</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">,</span> <span class="token number">900</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>


department_name <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;技术部&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;推广部&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;客服部&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;行政部&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;财务部&#39;</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> dep <span class="token keyword">in</span> department_name<span class="token punctuation">:</span>
    xls_name <span class="token operator">=</span> <span class="token string">&quot;{}-{}.xls&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">&quot;%Y-%m&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dep<span class="token punctuation">)</span>
    create_excel_file<span class="token punctuation">(</span>xls_name<span class="token punctuation">,</span> dep<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>xls_name<span class="token punctuation">,</span> <span class="token string">&quot; 新建完成&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>下面是财务文件和模板文件的截图：</p><p><img src="`+r+'" alt="image-20220715221653761" loading="lazy"></p><p><img src="'+d+'" alt="image-20220715222043587" loading="lazy"></p><p>财务文件中，每个用户数据，都是缺少应发工资的，需要用程序计算和填写；</p><p>模板文件的使用，需要将本月的部门财务文件全部计算并统计出来，然后填充到模板文件中，生成一个本月的数据总览表格，如下截图：</p><p><img src="'+m+`" alt="image-20220715222746640" loading="lazy"></p><p>选中的部分是需要使用程序自动填写。</p><p>一共有5个财务文件，每个文件有不固定个数的员工信息。</p><p>那接下来就开始写代码，实现自动化工资结算和统计报表的任务。</p><h2 id="库的导入和准备代码" tabindex="-1"><a class="header-anchor" href="#库的导入和准备代码" aria-hidden="true">#</a> 库的导入和准备代码</h2><p>首先第一步，导入需要的库，生成时间对象。还有就是文件夹中，放着很多文件，有 <code>xls</code>、<code>ipynb</code> 等格式，所以还需指定要操作的文件名，如下代码：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> datetime
<span class="token keyword">import</span> xlrd<span class="token punctuation">,</span> xlwt
<span class="token keyword">from</span> xlutils<span class="token punctuation">.</span>copy <span class="token keyword">import</span> copy

department <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;技术部&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;推广部&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;客服部&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;行政部&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;财务部&#39;</span><span class="token punctuation">]</span>
template_name <span class="token operator">=</span> <span class="token string">&quot;月结统计模板.xls&quot;</span>
today_datetime <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
need_process_xls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> dep <span class="token keyword">in</span> department<span class="token punctuation">:</span>
    xls_name <span class="token operator">=</span> <span class="token string">&quot;{}-{}.xls&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">&quot;%Y-%m&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dep<span class="token punctuation">)</span>
    need_process_xls<span class="token punctuation">.</span>append<span class="token punctuation">(</span>xls_name<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>need_process_xls<span class="token punctuation">)</span>
<span class="token comment"># 输出：[&#39;2022-12-技术部.xls&#39;, &#39;2022-12-推广部.xls&#39;, &#39;2022-12-客服部.xls&#39;, &#39;2022-12-行政部.xls&#39;, &#39;2022-12-财务部.xls&#39;]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里指定了模板文件名，时间对象，然后批量的生成了所需处理的部门财务文件。</p><h2 id="python-自动化结算工资" tabindex="-1"><a class="header-anchor" href="#python-自动化结算工资" aria-hidden="true">#</a> Python 自动化结算工资</h2><p>每个财务文件都是完全一致的，就是数据的不同，所以接下来，做一个函数，所做的操作就是接收文件名，并计算出文件中全部人员的工资，并写入文件然后保存。代码如下：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">process_xls_return_data</span><span class="token punctuation">(</span>xls_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    wb <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span>xls_name<span class="token punctuation">)</span>
    wb_sheet <span class="token operator">=</span> wb<span class="token punctuation">.</span>sheet_by_index<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    xwb <span class="token operator">=</span> copy<span class="token punctuation">(</span>wb<span class="token punctuation">)</span>
    xwb_sheet <span class="token operator">=</span> xwb<span class="token punctuation">.</span>get_sheet<span class="token punctuation">(</span><span class="token string">&#39;sheet1&#39;</span><span class="token punctuation">)</span>
    rows <span class="token operator">=</span> wb_sheet<span class="token punctuation">.</span>nrows
    <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> rows<span class="token punctuation">)</span><span class="token punctuation">:</span>
        bm <span class="token operator">=</span> wb_sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
        xm <span class="token operator">=</span> wb_sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
        gh <span class="token operator">=</span> wb_sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
        gz <span class="token operator">=</span> wb_sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
        cdcs <span class="token operator">=</span> wb_sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
        jj <span class="token operator">=</span> wb_sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
        sfgz <span class="token operator">=</span> gz <span class="token operator">-</span> <span class="token punctuation">(</span>cdcs <span class="token operator">*</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">+</span> jj  <span class="token comment"># 实发工资 = 工资  -  （迟到次数*20）  +  奖金</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>bm<span class="token punctuation">,</span> xm<span class="token punctuation">,</span> gh<span class="token punctuation">,</span> gz<span class="token punctuation">,</span> cdcs<span class="token punctuation">,</span> jj<span class="token punctuation">,</span> sfgz<span class="token punctuation">)</span>
        xwb_sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> sfgz<span class="token punctuation">)</span>
        xwb<span class="token punctuation">.</span>save<span class="token punctuation">(</span>xls_name<span class="token punctuation">)</span>


<span class="token keyword">for</span> cls <span class="token keyword">in</span> need_process_xls<span class="token punctuation">:</span>
    process_xls_return_data<span class="token punctuation">(</span>cls<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>对函数代码进行介绍：</p><ul><li>打开文件，打开 sheet，复制文件，读取文件中数据的总行数；</li><li>从第二行【索引1】开始，读取 部门、姓名、工号、工资、迟到次数、奖金；</li><li>然后计算应发工资，公式：应该工资 = 工资 - （迟到次数*20） + 奖金；</li><li>将应该工资写入到当前行的第7个位置【索引6】上；</li><li>最后保存，保存的文件名依旧是源文件名；</li><li>完成单个文件的操作；</li></ul><p>最下面的 for 循环，就是循环读取要操作的全部财务文件，逐个进入函数中操作，计算工资和保存。</p><h2 id="python-自动化结算工资-报表统计" tabindex="-1"><a class="header-anchor" href="#python-自动化结算工资-报表统计" aria-hidden="true">#</a> Python 自动化结算工资+报表统计</h2><p>自动化的工资结算已经处理好了，下面就是统计各个部门的财务报表。</p><p>报表中，需要写入 部门、总人数、迟到人数、拿奖金人数、应发总工资这五项，还有头部的“<code>xxxx-xx-各部门员工数据总览</code>”</p><p>部门的数据，都是从单个的部门财务文件中获取，例如迟到人数和拿奖金人数，都是判断是否迟到和是否有奖金，都用一个参数进行记录。</p><p>这个需求，可以在原来的函数之上，做个统计操作，并在函数结尾时，将这五个数据，做成列表并返回回去。</p><p>最后一个就是统计报表的头部字段，里面含有年份和月份，这个可以直接使用时间对象生成即可，但是字体的大小和居中效果是需要额外定义样式 style 的，所以这部分代码比较突兀，大家看懂即可。</p><p>如下代码：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">process_xls_return_data</span><span class="token punctuation">(</span>xls_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    staff_number <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment"># 总人数字段</span>
    cd_number <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment"># 迟到人数字段</span>
    jj_number <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment"># 拿奖金人数字段</span>
    total_pay <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment"># 总应发工资字段</span>
    wb <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span>xls_name<span class="token punctuation">,</span> formatting_info<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    wb_sheet <span class="token operator">=</span> wb<span class="token punctuation">.</span>sheet_by_index<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    xwb <span class="token operator">=</span> copy<span class="token punctuation">(</span>wb<span class="token punctuation">)</span>
    xwb_sheet <span class="token operator">=</span> xwb<span class="token punctuation">.</span>get_sheet<span class="token punctuation">(</span><span class="token string">&#39;sheet1&#39;</span><span class="token punctuation">)</span>
    rows <span class="token operator">=</span> wb_sheet<span class="token punctuation">.</span>nrows
    <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> rows<span class="token punctuation">)</span><span class="token punctuation">:</span>
        staff_number <span class="token operator">=</span> staff_number <span class="token operator">+</span> <span class="token number">1</span>  <span class="token comment"># 每个数据都是一个员工，直接+1</span>
        bm <span class="token operator">=</span> wb_sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value  <span class="token comment"># 部门名称</span>
        xm <span class="token operator">=</span> wb_sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
        gh <span class="token operator">=</span> wb_sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
        gz <span class="token operator">=</span> wb_sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
        cdcs <span class="token operator">=</span> wb_sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
        <span class="token keyword">if</span> cdcs <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token comment"># 如果迟到次数大于0，则是迟到过的人，迟到人数+1</span>
            cd_number <span class="token operator">=</span> cd_number <span class="token operator">+</span> <span class="token number">1</span>
        jj <span class="token operator">=</span> wb_sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
        <span class="token keyword">if</span> jj <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token comment"># 如果奖金大于0，则是获得了奖金的人，拿奖金人数+1</span>
            jj_number <span class="token operator">=</span> jj_number <span class="token operator">+</span> <span class="token number">1</span>
        sfgz <span class="token operator">=</span> gz <span class="token operator">-</span> <span class="token punctuation">(</span>cdcs <span class="token operator">*</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">+</span> jj  <span class="token comment"># 实发工资 = 工资  -  （迟到次数*20）  +  奖金</span>
        total_pay <span class="token operator">=</span> total_pay <span class="token operator">+</span> sfgz  <span class="token comment"># 将所有的实发工资加到一起，就是总的实发工资</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>bm<span class="token punctuation">,</span> xm<span class="token punctuation">,</span> gh<span class="token punctuation">,</span> gz<span class="token punctuation">,</span> cdcs<span class="token punctuation">,</span> jj<span class="token punctuation">,</span> sfgz<span class="token punctuation">)</span>
        xwb_sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> sfgz<span class="token punctuation">)</span>
    xwb<span class="token punctuation">.</span>save<span class="token punctuation">(</span>xls_name<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">[</span>bm<span class="token punctuation">,</span> staff_number<span class="token punctuation">,</span> cd_number<span class="token punctuation">,</span> jj_number<span class="token punctuation">,</span> total_pay<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>bm<span class="token punctuation">,</span> staff_number<span class="token punctuation">,</span> cd_number<span class="token punctuation">,</span> jj_number<span class="token punctuation">,</span> total_pay<span class="token punctuation">]</span>  <span class="token comment"># 最后将部门 总人数  总迟到人数  总拿奖金人数  总实发工资做成列表，一并返回</span>


all_info <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> cls <span class="token keyword">in</span> need_process_xls<span class="token punctuation">:</span>
    one_partment <span class="token operator">=</span> process_xls_return_data<span class="token punctuation">(</span>cls<span class="token punctuation">)</span>
    all_info<span class="token punctuation">.</span>append<span class="token punctuation">(</span>one_partment<span class="token punctuation">)</span>  <span class="token comment"># 将函数的返回值，放到列表中，就得到了所有部门的统计信息</span>

wb <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span>template_name<span class="token punctuation">,</span> formatting_info<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
wb_sheet <span class="token operator">=</span> wb<span class="token punctuation">.</span>sheet_by_index<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
xwb <span class="token operator">=</span> copy<span class="token punctuation">(</span>wb<span class="token punctuation">)</span>
xwb_sheet <span class="token operator">=</span> xwb<span class="token punctuation">.</span>get_sheet<span class="token punctuation">(</span><span class="token string">&#39;Sheet1&#39;</span><span class="token punctuation">)</span>
current_row <span class="token operator">=</span> wb_sheet<span class="token punctuation">.</span>nrows
year_month <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">&quot;%Y-%m&quot;</span><span class="token punctuation">)</span>
title <span class="token operator">=</span> <span class="token string">&quot;{}-各部门员工数据总览&quot;</span>


<span class="token keyword">def</span> <span class="token function">create_style</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 定义字体格式，返回一个字体大小24，垂直居中 水平居中 宋体格式 的样式</span>
    style <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>XFStyle<span class="token punctuation">(</span><span class="token punctuation">)</span>
    fnt <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>Font<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 创建一个文本格式，包括字体、字号和颜色样式特性</span>
    fnt<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">u&#39;宋体&#39;</span>
    fnt<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">20</span> <span class="token operator">*</span> <span class="token number">24</span>
    alignment <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>Alignment<span class="token punctuation">(</span><span class="token punctuation">)</span>
    alignment<span class="token punctuation">.</span>horz <span class="token operator">=</span> <span class="token number">0x02</span>  <span class="token comment"># 0x01(左端对齐)、0x02(水平方向上居中对齐)、0x03(右端对齐)</span>
    alignment<span class="token punctuation">.</span>vert <span class="token operator">=</span> <span class="token number">0x01</span>  <span class="token comment"># 0x00(上端对齐)、 0x01(垂直方向上居中对齐)、0x02(底端对齐)</span>
    style<span class="token punctuation">.</span>font <span class="token operator">=</span> fnt
    style<span class="token punctuation">.</span>alignment <span class="token operator">=</span> alignment
    <span class="token keyword">return</span> style


xwb_sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> title<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>year_month<span class="token punctuation">)</span><span class="token punctuation">,</span> create_style<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 写入头部标题，内容是“xxxx-xx-各部门员工数据总览”，样式是 宋体 大小24 垂直水平居中</span>

<span class="token keyword">for</span> info <span class="token keyword">in</span> all_info<span class="token punctuation">:</span>  <span class="token comment"># 循环所有的部门信息，全部写入到文件中</span>
    xwb_sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span>current_row<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> info<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    xwb_sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span>current_row<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> info<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    xwb_sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span>current_row<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> info<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    xwb_sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span>current_row<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> info<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    xwb_sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span>current_row<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> info<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    current_row <span class="token operator">=</span> current_row <span class="token operator">+</span> <span class="token number">1</span>
xwb<span class="token punctuation">.</span>save<span class="token punctuation">(</span>title<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>year_month<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;.xls&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># 最后保存，文件名是 xxxx-xx-各部门员工数据总览.xls</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这个代码是基于上一个函数代码的，多了部门信息统计和基于模板文件生成”<code>xxxx-xx-各部门员工数据总览.xls</code>“的统计文件</p><p>以上就是本次任务的实现过程。结合代码块1和代码块3，就是完整的代码块。</p><p>源码中有文中的全部代码文件，包含“<code>批量生成财务报表.ipynb</code>”的代码文件，可以自动生成任意多个部门和任意多个员工的财务文件。</p><p>欢迎关注我公众号：AI悦创，有更多更好玩的等你发现！</p><details class="custom-container details"><summary>公众号：AI悦创【二维码】</summary><p><img src="`+p+'" alt="" loading="lazy"></p></details>',42),_={class:"custom-container info"},w=n("p",{class:"custom-container-title"},"AI悦创·编程一对一",-1),h=n("p",null,"AI悦创·推出辅导班啦，包括「Python 语言辅导班、C++ 辅导班、java 辅导班、算法/数据结构辅导班、少儿编程、pygame 游戏开发」，全部都是一对一教学：一对一辅导 + 一对一答疑 + 布置作业 + 项目实践等。当然，还有线下线上摄影课程、Photoshop、Premiere 一对一教学、QQ、微信在线，随时响应！微信：Jiabcdefh",-1),x=n("p",null,"C++ 信息奥赛题解，长期更新！长期招收一对一中小学信息奥赛集训，莆田、厦门地区有机会线下上门，其他地区线上。微信：Jiabcdefh",-1),g={href:"http://wpa.qq.com/msgrd?v=3&uin=1432803776&site=qq&menu=yes",target:"_blank",rel:"noopener noreferrer"},y=n("p",null,"方法二：微信：Jiabcdefh",-1),f=n("p",null,[n("img",{src:t,alt:"",loading:"lazy"})],-1);function j(q,z){const a=i("ExternalLinkIcon");return o(),c("div",null,[v,n("div",_,[w,h,x,n("p",null,[s("方法一："),n("a",g,[s("QQ"),l(a)])]),y]),f])}const C=e(b,[["render",j],["__file","auto_base07.html.vue"]]);export{C as default};
