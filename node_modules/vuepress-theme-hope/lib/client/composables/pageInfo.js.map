{"version":3,"file":"pageInfo.js","sourceRoot":"","sources":["../../../src/client/composables/pageInfo.ts"],"names":[],"mappings":"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","sourcesContent":["import { usePageData, usePageFrontmatter } from \"@vuepress/client\";\nimport { computed, inject, reactive } from \"vue\";\nimport {\n  getAuthor,\n  getCategory,\n  getDate,\n  getTag,\n} from \"vuepress-shared/client\";\n\nimport { useThemeLocaleData } from \"./themeData.js\";\n\nimport type {\n  AuthorInfo,\n  BasePageFrontMatter,\n  DateInfo,\n} from \"vuepress-shared\";\nimport type { GitData } from \"@vuepress/plugin-git\";\nimport type { ComputedRef } from \"vue\";\nimport type { ReadingTime } from \"vuepress-plugin-reading-time2\";\nimport type { CategoryMapRef } from \"@theme-hope/modules/blog/composables/index.js\";\nimport type { PageInfoProps } from \"@theme-hope/modules/info/components/PageInfo.js\";\nimport type {\n  PageCategory,\n  PageTag,\n} from \"@theme-hope/modules/info/utils/index.js\";\nimport type {\n  HopeThemeNormalPageFrontmatter,\n  PageInfo,\n} from \"../../shared/index.js\";\n\ndeclare const ENABLE_BLOG: boolean;\ndeclare const SUPPORT_PAGEVIEW: boolean;\n\nexport const usePageAuthor = (): ComputedRef<AuthorInfo[]> => {\n  const themeLocale = useThemeLocaleData();\n  const frontmatter = usePageFrontmatter<BasePageFrontMatter>();\n\n  return computed(() => {\n    const { author } = frontmatter.value;\n\n    if (author) return getAuthor(author);\n    if (author === false) return [];\n\n    return getAuthor(themeLocale.value.author, false);\n  });\n};\n\nexport const usePageCategory = (): ComputedRef<PageCategory[]> => {\n  const frontmatter = usePageFrontmatter<BasePageFrontMatter>();\n\n  return computed(() =>\n    getCategory(frontmatter.value.category).map((name) => ({\n      name,\n      // this is a hack\n      path: ENABLE_BLOG\n        ? inject<CategoryMapRef>(Symbol.for(\"categoryMap\"))?.value.map[name]\n            ?.path || \"\"\n        : \"\",\n    }))\n  );\n};\n\nexport const usePageTag = (): ComputedRef<PageTag[]> => {\n  const frontmatter = usePageFrontmatter<BasePageFrontMatter>();\n\n  return computed(() =>\n    getTag(frontmatter.value.tag).map((name) => ({\n      name,\n      // this is a hack\n      path: ENABLE_BLOG\n        ? inject<CategoryMapRef>(Symbol.for(\"tagMap\"))?.value.map[name]?.path ||\n          \"\"\n        : \"\",\n    }))\n  );\n};\n\nexport const usePageDate = (): ComputedRef<DateInfo | null> => {\n  const frontmatter = usePageFrontmatter<BasePageFrontMatter>();\n  const page = usePageData<{ git?: GitData }>();\n\n  return computed(() => {\n    const { date } = frontmatter.value;\n\n    if (date) return getDate(date);\n\n    const { createdTime } = page.value.git || {};\n\n    if (createdTime) return getDate(new Date(createdTime));\n\n    return null;\n  });\n};\n\nexport const usePageInfo = (): {\n  config: PageInfoProps;\n  items: ComputedRef<PageInfo[] | false | null>;\n} => {\n  const themeLocale = useThemeLocaleData();\n  const page = usePageData<{\n    git?: GitData;\n    localizedDate: string;\n    readingTime: ReadingTime;\n  }>();\n  const frontmatter = usePageFrontmatter<HopeThemeNormalPageFrontmatter>();\n  const author = usePageAuthor();\n  const category = usePageCategory();\n  const tag = usePageTag();\n  const date = usePageDate();\n\n  const config = reactive<PageInfoProps>({\n    author: author.value,\n    category: category.value,\n    date: date.value,\n    localizedDate: page.value.localizedDate,\n    tag: tag.value,\n    isOriginal: frontmatter.value.isOriginal || false,\n    readingTime: page.value.readingTime,\n    pageview: SUPPORT_PAGEVIEW\n      ? \"pageview\" in frontmatter.value\n        ? frontmatter.value.pageview\n        : true\n      : false,\n  });\n\n  const items = computed(() =>\n    \"pageInfo\" in frontmatter.value\n      ? frontmatter.value.pageInfo\n      : \"pageInfo\" in themeLocale.value\n      ? themeLocale.value.pageInfo\n      : null\n  );\n\n  return { config, items };\n};\n"]}