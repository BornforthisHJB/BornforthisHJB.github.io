{"version":3,"file":"YouTube.js","sources":["../../../src/client/composables/size.ts","../../../src/client/components/YouTube.ts"],"sourcesContent":["import { useEventListener } from \"@vueuse/core\";\nimport { computed, onMounted, isRef, ref, unref, watch } from \"vue\";\nimport type { MaybeRef } from \"@vueuse/core\";\nimport type { Ref } from \"vue\";\n\nconst getValue = (value: string | number): string =>\n  typeof value === \"string\" ? value : `${value}px`;\n\nexport interface SizeOptions {\n  width: string | number | undefined;\n  height: string | number | undefined;\n  ratio: number | undefined;\n}\n\nexport interface SizeInfo<E extends HTMLElement> {\n  el: Ref<E | undefined>;\n  width: Ref<string>;\n  height: Ref<string>;\n}\n\nexport const useSize = <E extends HTMLElement>(\n  options: SizeOptions,\n  extraHeight: MaybeRef<number> = 0\n): SizeInfo<E> => {\n  const el = ref<E>();\n  const width = computed(() => getValue(unref(options.width) || \"100%\"));\n  const height = ref(\"auto\");\n\n  const getHeight = (width: number): string => {\n    const height = unref(options.height);\n    const ratio = unref(options.ratio) || 16 / 9;\n\n    return height\n      ? getValue(height)\n      : `${Number(width) / ratio + unref(extraHeight)}px`;\n  };\n\n  const updateHeight = (): void => {\n    height.value = getHeight(el.value!.clientWidth);\n  };\n\n  onMounted(() => {\n    updateHeight();\n    if (isRef(extraHeight)) watch(extraHeight, () => updateHeight());\n    useEventListener(\"orientationchange\", () => updateHeight());\n    useEventListener(\"resize\", () => updateHeight());\n  });\n\n  return {\n    el,\n    width,\n    height,\n  };\n};\n","import { usePageLang } from \"@vuepress/client\";\nimport { computed, defineComponent, h } from \"vue\";\n\nimport { useSize } from \"../composables/index.js\";\n\nimport type { VNode } from \"vue\";\n\nimport \"../styles/youtube.scss\";\n\nexport default defineComponent({\n  name: \"YouTube\",\n\n  props: {\n    id: {\n      type: String,\n      default: \"\",\n    },\n\n    width: {\n      type: [String, Number],\n      default: \"100%\",\n    },\n\n    height: {\n      type: [String, Number],\n      default: undefined,\n    },\n\n    ratio: {\n      type: Number,\n      default: 16 / 9,\n    },\n\n    autoplay: Boolean,\n    loop: Boolean,\n    showCc: Boolean,\n    showAnnotations: Boolean,\n\n    start: {\n      type: Number,\n      default: undefined,\n    },\n\n    end: {\n      type: Number,\n      default: undefined,\n    },\n\n    defaultCcLang: {\n      type: String,\n      default: \"\",\n    },\n\n    uiLang: {\n      type: String,\n      default: \"\",\n    },\n\n    listType: {\n      type: String,\n      default: \"\",\n    },\n\n    list: {\n      type: String,\n      default: \"\",\n    },\n\n    playlist: {\n      type: String,\n      default: \"\",\n    },\n\n    disableControls: Boolean,\n    disableFullscreen: Boolean,\n    disableKeyboard: Boolean,\n  },\n\n  setup(props) {\n    const lang = usePageLang();\n    const { el, width, height } = useSize<HTMLIFrameElement>(props);\n\n    const coreURL = computed(() =>\n      props.id\n        ? `${props.id}?`\n        : props.listType === \"playlist\" && props.list\n        ? `?listType=playlist&list=${\n            props.list.startsWith(\"PL\") ? props.list : `PL${props.list}`\n          }&`\n        : null\n    );\n\n    const params = computed(() => {\n      const params = new URLSearchParams();\n\n      if (props.autoplay) params.set(\"autoplay\", \"1\");\n      if (props.loop) params.set(\"loop\", \"1\");\n      if (props.showCc) params.set(\"cc_load_policy\", \"1\");\n      if (props.showAnnotations) params.set(\"iv_load_policy\", \"3\");\n\n      if (props.start) params.set(\"start\", props.start.toString());\n      if (props.end) params.set(\"end\", props.end.toString());\n\n      params.set(\"hl\", props.uiLang || lang.value);\n      params.set(\"cc_lang_pref\", props.defaultCcLang || lang.value);\n      params.set(\"color\", \"white\");\n\n      if (props.disableControls) params.set(\"controls\", \"0\");\n      if (props.disableFullscreen) params.set(\"fs\", \"0\");\n      if (props.disableKeyboard) params.set(\"disablekb\", \"1\");\n\n      if (props.playlist) params.set(\"playlist\", props.playlist);\n\n      return params.toString();\n    });\n\n    return (): VNode | null =>\n      coreURL.value\n        ? h(\"iframe\", {\n            ref: el,\n            src: `https://www.youtube.com/embed/${coreURL.value}${params.value}`,\n            class: \"youtube-iframe\",\n            allow:\n              \"accelerometer; autoplay; clipboard-write; encrypted-media; fullscreen; gyroscope; picture-in-picture\",\n            style: {\n              width: width.value,\n              height: height.value,\n            },\n          })\n        : null;\n  },\n});\n"],"names":["getValue","value","useSize","options","extraHeight","el","ref","width","computed","unref","height","getHeight","ratio","updateHeight","onMounted","isRef","watch","useEventListener","YouTube","defineComponent","props","lang","usePageLang","coreURL","params","h"],"mappings":"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"}