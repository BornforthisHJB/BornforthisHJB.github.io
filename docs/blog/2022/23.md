---
title: wireshark 抓包新手使用教程
date: 2022-10-17 09:55:10
author: AI悦创
isOriginal: true
category: 
    - Chrome
    - 网络安全工程师
    - 抓包
tag:
    - Chrome
    - 网络安全工程师
    - 抓包
icon: network
sticky: false
star: false
password: false
article: true
timeline: true
image: false
navbar: true
sidebarIcon: true
headerDepth: 5
comment: true
lastUpdated: true
editLink: true
backToTop: true
toc: true
---

你好，我是悦创。我一个朋友问到这样的抓包问题：

::: details

<img src="./23.assets/image-20221017095720036.png" alt="image-20221017095720036" style="zoom: 50%;" />

<img src="./23.assets/image-20221017100017875.png" alt="image-20221017100017875" style="zoom: 50%;" />

<img src="./23.assets/image-20221017100055586.png" alt="image-20221017100055586" style="zoom:50%;" />

<img src="./23.assets/image-20221017100120953.png" alt="image-20221017100120953" style="zoom:50%;" />

<img src="./23.assets/image-20221017100200658.png" alt="image-20221017100200658" style="zoom:50%;" />

:::

Wireshark 是非常流行的网络封包分析软件，可以截取各种网络数据包，并显示数据包详细信息。常用于开发测试过程各种问题定位。本文主要内容包括：

 1、Wireshark 软件下载和安装以及 Wireshark 主界面介绍。

 2、WireShark 简单抓包示例。通过该例子学会怎么抓包以及如何简单查看分析数据包内容。

 3、Wireshark 过滤器使用。过滤器包含两种类型，一种是抓包过滤器，就是抓取前设置过滤规则。另外一种是显示过滤器，就是在数据包分析时进行过滤数据使用。通过过滤器可以筛选出想要分析的内容。包括按照协议过滤、端口和主机名过滤、数据包内容过滤。具体规则和实例可以查看正文。

## Wireshark 软件安装

 软件下载路径：[wireshark 官网](https://www.wireshark.org/)。按照系统版本选择下载，下载完成后，按照软件提示一路 Next 安装。

 说明：如果你是 Win10 系统，安装完成后，选择抓包但是不显示网卡，下载 win10pcap 兼容性安装包。下载路径：[win10pcap兼容性安装包](http://www.win10pcap.org/download/)

# **Wireshark 开始抓包示例**

  先介绍一个使用 wireshark 工具抓取 ping 命令操作的示例，让读者可以先上手操作感受一下抓包的具体过程。

### 1. 打开 wireshark 4.0.0，主界面如下：

![image-20221017100717955](./23.assets/image-20221017100717955.png)

### 2. 选择菜单栏上 Capture -> Option，勾选 WLAN 网卡（这里需要根据各自电脑网卡使用情况选择，简单的办法可以看使用的 IP 对应的网卡）。点击 Start。启动抓包。

![image-20221017100919439](./23.assets/image-20221017100919439.png)

### 3. wireshark 启动后，wireshark 处于抓包状态中。

![image-20221017170240785](./23.assets/image-20221017170240785.png)

### 4. 执行需要抓包的操作，如在cmd 窗口下执行ping www.baidu.com。

### 5. 作完成后相关数据包就抓取到了。为避免其他无用的数据包影响分析，可以通过在过滤栏设置过滤条件进行数据包列表过滤，获取结果如下。

说明：ip.addr == 39.156.66.10 and icmp 表示只显示ICPM协议且源主机 IP 或者目的主机 IP 为 119.75.217.26 的数据包。说明：协议名称 icmp 要小写。

![image-20221017170407154](./23.assets/image-20221017170407154.png)

### 6. wireshark 抓包完成，就这么简单。关于 wireshark 显示过滤条件、抓包过滤条件、以及如何查看数据包中的详细内容在后面介绍。

## Wireshakr 抓包界面介绍

![img](./23.assets/774327-20181216083953866-9796212.png)

说明：数据包列表区中不同的协议使用了不同的颜色区分。协议颜色标识定位在菜单栏 View --> Coloring Rules。如下所示

![image-20221017171541963](./23.assets/image-20221017171541963.png)

### WireShark 主要分为这几个界面

#### 1. Display Filter (显示过滤器)， 用于设置过滤条件进行数据包列表过滤。菜单路径：Analyze --> Display Filters。

![image-20221017171746610](./23.assets/image-20221017171746610.png)

![img](./23.assets/774327-20181216161033619-451281242.png)

#### 2. Packet List Pane(数据包列表)， 显示捕获到的数据包，每个数据包包含编号，时间戳，源地址，目标地址，协议，长度，以及数据包信息。 不同协议的数据包使用了不同的颜色区分显示。

![img](./23.assets/774327-20181216161154412-766346180.png)

#### 3. Packet Details Pane(数据包详细信息), 在数据包列表中选择指定数据包，在数据包详细信息中会显示数据包的所有详细信息内容。数据包详细信息面板是最重要的，用来查看协议中的每一个字段。各行信息分别为

 （1）Frame:  物理层的数据帧概况

 （2）Ethernet II: 数据链路层以太网帧头部信息

 （3）Internet Protocol Version 4: 互联网层IP包头部信息

 （4）Transmission Control Protocol: 传输层T的数据段头部信息，此处是TCP

 （5）Hypertext Transfer Protocol: 应用层的信息，此处是HTTP协议

![img](./23.assets/2013050217125736394.png)

### TCP 包的具体内容

 从下图可以看到 wireshark 捕获到的 TCP 包中的每个字段。

![img](./23.assets/2013050217125787134.png)

#### 4. Dissector Pane(数据包字节区)。

## Wireshark 过滤器设置

初学者使用 wireshark 时，将会得到大量的冗余数据包列表，以至于很难找到自己需要抓取的数据包部分。wireshark 工具中自带了两种类型的过滤器，学会使用这两种过滤器会帮助我们在大量的数据中迅速找到我们需要的信息。

### （1）抓包过滤器

  捕获过滤器的菜单栏路径为 Capture --> Capture Filters。用于**在抓取数据包前设置。**

![img](./23.assets/774327-20181216161942199-694292737.png)

如何使用？可以在抓取数据包前设置如下。

![img](./23.assets/774327-20181216162715878-976869768.png)

![image-20221017174313478](./23.assets/image-20221017174313478.png)

ip host 60.207.246.216 and icmp 表示只捕获主机IP为 60.207.246.216 的 ICMP 数据包。获取结果如下：

![img](./23.assets/774327-20181216162922295-1140020404.png)

### （2）显示过滤器

显示过滤器是用于在抓取数据包后设置过滤条件进行过滤数据包。通常是在抓取数据包时设置条件相对宽泛或者没有设置导致抓取的数据包内容较多时使用显示过滤器设置条件过滤以方便分析。同样上述场景，在捕获时未设置抓包过滤规则直接通过网卡进行抓取所有数据包，如下

![img](./23.assets/774327-20181216163301344-1400128534.png)

执行 `ping www.huawei.com`  获取的数据包列表如下：

![img](./23.assets/774327-20181216163359260-101806867.png)

观察上述获取的数据包列表，含有大量的无效数据。这时可以通过设置显示器过滤条件进行提取分析信息。`ip.addr == 211.162.2.183 and icmp`。并进行过滤。

![img](./23.assets/774327-20181216163607973-642074591.png)

上述介绍了抓包过滤器和显示过滤器的基本使用方法。**在组网不复杂或者流量不大情况下，使用显示器过滤器进行抓包后处理就可以满足我们使用。**下面介绍一下两者间的语法以及它们的区别。

## wireshark 过滤器表达式的规则

### 1. 抓包过滤器语法和实例

抓包过滤器类型 Type（host、net、port）、方向Dir（src、dst）、协议Proto（ether、ip、tcp、udp、http、icmp、ftp等）、逻辑运算符（&& 与、|| 或、！非）

#### （1）协议过滤

 比较简单，直接在抓包过滤框中直接输入协议名即可。

 tcp，只显示 TCP 协议的数据包列表

 http，只查看 HTTP 协议的数据包列表

 icmp，只显示 ICMP 协议的数据包列表

#### （2）IP过滤

 host 192.168.1.104

 src host 192.168.1.104

 dst host 192.168.1.104

#### （3）端口过滤

 port 80

 src port 80

 dst port 80

#### （4）逻辑运算符&& 与、|| 或、！非

src host 192.168.1.104 && dst port 80 抓取主机地址为192.168.1.80、目的端口为80的数据包

host 192.168.1.104 || host 192.168.1.102 抓取主机为192.168.1.104或者192.168.1.102的数据包

!broadcast 不抓取广播数据包

### 2. 显示过滤器语法和实例

#### （1）比较操作符

 比较操作符有== 等于、！= 不等于、> 大于、< 小于、>= 大于等于、<=小于等于。

#### （2）协议过滤

 比较简单，直接在 Filter 框中直接输入协议名即可。**注意：协议名称需要输入小写。**

 tcp，只显示TCP协议的数据包列表

 http，只查看HTTP协议的数据包列表

 icmp，只显示ICMP协议的数据包列表



欢迎关注我公众号：AI悦创，有更多更好玩的等你发现！

::: details 公众号：AI悦创【二维码】

![](/gzh.jpg)

:::

::: info AI悦创·编程一对一

AI悦创·推出辅导班啦，包括「Python 语言辅导班、C++ 辅导班、java 辅导班、算法/数据结构辅导班、少儿编程、pygame 游戏开发」，全部都是一对一教学：一对一辅导 + 一对一答疑 + 布置作业 + 项目实践等。当然，还有线下线上摄影课程、Photoshop、Premiere 一对一教学、QQ、微信在线，随时响应！微信：Jiabcdefh

C++ 信息奥赛题解，长期更新！长期招收一对一中小学信息奥赛集训，莆田、厦门地区有机会线下上门，其他地区线上。微信：Jiabcdefh

方法一：[QQ](http://wpa.qq.com/msgrd?v=3&uin=1432803776&site=qq&menu=yes)

方法二：微信：Jiabcdefh

:::

![](/zsxq.jpg)
