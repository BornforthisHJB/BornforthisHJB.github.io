---
title: 决策树算法
date: 2022-10-13 18:29:10
author: AI悦创
isOriginal: true
category: 
    - 机器学习算法
    - 机器学习实战
    - Machine learning
tag:
    - 机器学习算法
    - 机器学习实战
    - Machine learning
icon: python
sticky: false
star: false
password: false
article: true
timeline: true
image: false
navbar: true
sidebarIcon: true
headerDepth: 5
comment: true
lastUpdated: true
editLink: false
backToTop: true
toc: true
---

## 1. 决策树算法概述

你好，我是悦创。

<img src="./02-决策树算法.assets/image-20221013184927400.png" alt="image-20221013184927400" style="zoom: 67%;" />

家里有五口人，爷爷奶奶、两个孩子、一个母亲。

我们要做个分类，在分类中，我们要做个判断：谁爱玩电脑游戏。

谁爱玩电脑游戏肯定是数据当中这些特征所决定的吧，假如当前数据中有两个特征：年龄、性别。这两个特征都会对结果产生影响。上图是我们现在构建出决策树的模型。

从数据栏当中，回落到第一个判断的键当中。

从上往下走，通过对年龄的判断，年龄是不是小于 15 岁，如果年龄小于 15岁，他是潜在有玩游戏的可能性的。那就让他往左边走：

<img src="./02-决策树算法.assets/image-20221022222024090.png" alt="image-20221022222024090" style="zoom: 50%;" />

如果不是小于 15岁的，我们就把他排除在外了，认为他是不喜欢玩电脑游戏的。

<img src="./02-决策树算法.assets/image-20221022223251879.png" alt="image-20221022223251879" style="zoom: 50%;" />



所以，我们第一步通过这个年龄的判断，有些喜欢玩有些不喜欢玩。那现在，不喜欢玩的，相当于到这里就截止了。

<img src="./02-决策树算法.assets/image-20221022223446907.png" alt="image-20221022223446907" style="zoom:50%;" />



那左边我们继续，我们不光对他的年龄做了一个判断，接下来我们对他的性别再做了一次判断。如果，是一个男孩的话，他是喜欢玩游戏的。如果她是女孩是不喜欢玩游戏的。

<img src="./02-决策树算法.assets/image-20221022223645321.png" alt="image-20221022223645321" style="zoom:50%;" />

上面所描述的就是决策，解决问题的基本流程。看起来是不是比较简单呢？

那大家想一下：当大家看到上面的决策树的时候，大家能不能想到什么问题呢？或者说这里有没有一些东西，值得我们思考一下。

回想一下，左边是样本，右边是我们的判断树，我们先判断了年龄，看是不是小于 15、又判断了性别，是男孩还是女孩。那此时大家肯定会问一个问题：我能不能先判断性别，再判断年龄。在这个项目中好像也是的，也是可以的。

反正这个小男孩，是男性且必须小于 15 岁。——那先判断哪一个应该都可以吧，应该没有什么区别吧。

**但是，** 在决策树中，不是这样的。决策树把前后顺序把控的特别严格。一旦你把前后顺序改变，最后的结果，一定会发生一些变化的。

### 1.1 树模型

-   决策树：从根节点开始一步步走到叶子节点（决策）

-   所有的数据最终都会落到叶子节点，既可以做分类也可以做回归

那我们来想想，为什么把年龄放在第一个，性别放在下一个呢？你说，我们要做一个分类任务。然后这个分类任务要分两次去做。所以，我们都希望在第一次做的时候，尽可能都做对了。第二次做的时候，再做一个微调，再做一个细致一些的划分。 **「第一次过滤的时候，过滤大部分的数据，第二次过滤的时候过滤一些细致性的东西」**

所以说，在决策树当中，也是遵循这个点。

我们把起始的特征，叫做：根节点。这个区分比较强的，把它放在最前面。「它可以进行大致的判断」

那下面，老二来了。它虽然没有根节点强，但也能起到划分的作用。「细化」——那你说老大和老二能替换吗？一个首发阵容、一个替补整容。能替换么？

先上场哪个，肯定先上首发是不。不能上替补吧～

所以说，我们先放哪个节点，就是哪个比较厉害的，把结果分的比较厉害。接下来再上替补，进行细致的划分。

**那你会问：凭什么 age 是首发，sex 是替补？**

我给你讲的决策树的模型，就是为了解决这一的问题。

决策树可以做分类回归。

### 1.2 树组成

![image-20221023160201958](./02-决策树算法.assets/image-20221023160201958.png)





-   根节点：第一个选择点

-   非叶子节点与**分支**：中间过程

-   叶子节点：最终的决策结果

### 1.3 决策树的训练与测试

-   训练阶段：从给定的训练集构造出来一棵树（从跟节点开始选择特征，如何进行特征切分）「核心」

-   测试阶段：根据构造出来的树模型从上到下去走一遍就好了「有数据，得到结果」

-   一旦构造好了决策树，那么分类或者预测任务就很简单了，只需要走一遍就可以了，那么难点就在于如何构造出来一颗树，这就没那么容易了，需要考虑的问题还有很多的！「也就是比如上面的例子，为什么是小于 15岁，18岁可不可以？19岁呢？」也就是这些数据才是最难的。



## 2. 熵的作用

那接下来我们来说决策树中最核心的一点：怎样选特征！（我为什么选择年龄作为根节点？为什么选择 15岁呢？）这个就是我们现在的问题，这个问题很重要。

### 2.1 如何切分特征（选择节点）

-   问题：根节点的选择该用哪个特征呢？接下来呢？如何切分呢？

-   想象一下：我们的目标应该是根节点就像一个老大似的能更好的切分数据（分类的效果更好），根节点下面的节点自然就是二当家了。

-   目标：通过一种衡量标准，来计算通过不同特征进行分支选择后的分类情况，找出来最好的那个当成根节点，以此类推。

比如你数据集中有十个特征：年龄、性别、xxxxxxx

那用哪个呀？——肯定选择分类效果最强的特征。当做大当家。

大当家好了之后，来二当家。以此类推。。。。。。

**那我，怎么选择出大当家呢？**

需要一种判断方法，找到一个标准！以数据说话。

### 2.2 衡量标准-熵

-   熵：熵是表示随机变量不确定性的度量（解释：说白了就是物体内部的混乱程度，比如杂货市场里面什么都有那肯定混乱呀，专卖店里面只卖一个牌子的那就稳定多啦）

>   按我的来说就是：**混乱程度** ，你现在到了义乌小杂货市场。这不是有两元店、十元店、卖包、卖鞋的都有。那你说你到两元店里面，里面一百多个商品。你买某一个商品的可能性——高还是低呢？
>
>   里面一百多个商品，你就偏偏买扑克牌，那你选中扑克牌的可能性是高还是低？——显然是比较低的吧。——**为什么？**
>
>   因为，它里面可选的东西太多了。杂七杂八的杂货市场，啥都有。你买其中的随便一个东西，概率都很低的。
>
>   那你说：杂货市场，混不混乱。显然是混乱的。——你到两元店里面，买啥都不确定。越混乱的地方，不确定的度量就高呀～此时，你的墒值就 **大** 。
>
>    **那什么时候墒值小呢？**
>
>   你想在要买手机，到了苹果专卖店，说：我想买部华为手机，人家是不是得打你呀。——你到苹果专卖店，是不是只能买到苹果手机，那你说你有什么不确定性呢？你已经非常确定了，你只能买苹果手机。所以说，此时的不确定性度量非常小。那墒值就小吧。

上面就简单的跟你说墒值什么时候大，什么时候小。

那熵值什么时候大、什么时候小，跟我们决策树有什么关系？

举个例子：

我现在有两个类别：

<img src="./02-决策树算法.assets/image-20221023165721769.png" alt="image-20221023165721769" style="zoom:50%;" />

那从上面的结果来看，分不分的开？——显然是分不开的。那比如现在 100 个类别，那左边的混进去 100 个类别，那左边的熵值就比较的大。那我再画另外一种：

<img src="./02-决策树算法.assets/image-20221023170000112.png" alt="image-20221023170000112" style="zoom:50%;" />



那现在上面为 A 方案，下面为 B 方案，你说哪个方案好？——肯定 B 方案好吧，B 方案后，为的左子树和右子树都是比较纯的吧。都是自己家人，圆圈都放一起了。数据也比较纯了。

这就是我们分类的一个标准，咱们要找到一个衡量标准，也就是分类效果的好坏。怎么评估呢？看分类完，经过一次决策完之后，咱们熵值的大小。

接下来，我们来看公式。

-   公式：$H(X) = - \sum * log_2, i = 1, 2, ..., n$









## 3. 信息增益原理





























































































































欢迎关注我公众号：AI悦创，有更多更好玩的等你发现！

::: details 公众号：AI悦创【二维码】

![](/gzh.jpg)

:::

::: info AI悦创·编程一对一

AI悦创·推出辅导班啦，包括「Python 语言辅导班、C++ 辅导班、java 辅导班、算法/数据结构辅导班、少儿编程、pygame 游戏开发」，全部都是一对一教学：一对一辅导 + 一对一答疑 + 布置作业 + 项目实践等。当然，还有线下线上摄影课程、Photoshop、Premiere 一对一教学、QQ、微信在线，随时响应！微信：Jiabcdefh

C++ 信息奥赛题解，长期更新！长期招收一对一中小学信息奥赛集训，莆田、厦门地区有机会线下上门，其他地区线上。微信：Jiabcdefh

方法一：[QQ](http://wpa.qq.com/msgrd?v=3&uin=1432803776&site=qq&menu=yes)

方法二：微信：Jiabcdefh

:::

![](/zsxq.jpg)